Diamonds data set exploration
========================================================
***
# Problem set 1

### Task 1 "Diamonds"
```{r}
# Load ggplot2 and diamonds data set 
library(ggplot2)
data(diamonds)

# Checking variables and main parameters
summary(diamonds)
names(diamonds)
```

### Task 2 "Price Histogram"
```{r}
# Histogram of the price of all the diamonds in the diamond data set.
ggplot(data = diamonds, aes(x = price)) + 
	geom_histogram()
```

### Task 3 "Price Histogram Summary"
* Noticeable spike in the diamonds' price range from 625 to 1 250; 
* Median price is 2 410;
* Mean price is 3 932.8;
* Distribution is close to normal.

### Task 4 "Diamond Counts"
```{r}
#how many diamonds cost less than 500$?
nrow(subset(diamonds, price < 500))

#how many diamonds cost less than 250$?
nrow(subset(diamonds, price < 250))

#how many diamonds cost 15 000$ or more?
nrow(subset(diamonds, price >= 15000))

```

### Task 5 "Cheaper Diamonds"
```{r}
#some manipulations with x axis
ggplot(data = diamonds, aes(x = price)) +
  geom_histogram(color = "white", fill = "darkblue", binwidth = 500) +
  scale_x_continuous(limits = c(0, 20000), breaks = seq(0, 20000, 2500)) + 
  xlab("Price of the diamonds") + 
  ylab("Quantity of the diamonds")

#looks like two patterns of normal distribution
ggplot(data = diamonds, aes(x = log10(price))) +
  geom_histogram(color = "white", fill = "darkblue", binwidth = 0.05) + 
  xlab("Price of the diamonds") + 
  ylab("Quantity of the diamonds")

```

### Task 6 "Price by Cut Histogram"
```{r}
library(gridExtra)
levels(diamonds$cut)

pbc1 <- ggplot(data = subset(diamonds, cut == "Fair"), aes(x = price)) +
          geom_histogram(color = "white", fill = "darkblue")  

pbc2 <- ggplot(data = subset(diamonds, cut == "Good"), aes(x = price)) +
          geom_histogram(color = "white", fill = "darkblue")

pbc3 <- ggplot(data = subset(diamonds, cut == "Very Good"), aes(x = price)) +
          geom_histogram(color = "white", fill = "darkblue")

pbc4 <- ggplot(data = subset(diamonds, cut == "Premium"), aes(x = price)) +
          geom_histogram(color = "white", fill = "darkblue")

pbc5 <- ggplot(data = subset(diamonds, cut == "Ideal"), aes(x = price)) +
          geom_histogram(color = "white", fill = "darkblue")

grid.arrange(pbc1, pbc2, pbc3, pbc4, pbc5, ncol = 3)

#more direct approach
qplot(x = price, data=diamonds, binwidth = 500) +
  geom_histogram() +
  facet_wrap(~cut, ncol=2, scales="free_y")
```

### Task 7 "Price by Cut"
```{r}
#Which cut has the highest priced diamond?
by(diamonds$price, diamonds$cut, max)

#Which cut has the lowest priced diamond?
by(diamonds$price, diamonds$cut, min)

#Which cut has the lowest median price?
by(diamonds$price, diamonds$cut, median)

```

### Task 8 "Scales and Multiple Histograms"
```{r}
qplot(x = price, data=diamonds, binwidth = 500) +
  geom_histogram() +
  facet_wrap(~cut, ncol=2, scales="free_y")
```

### Task 9 "Price per Carat by Cut"
```{r}
qplot(x = price/carat, data=diamonds) +
  geom_histogram() +
  facet_wrap(~cut, ncol=2, scales="free_y") +
  scale_x_log10()
```

### Task 10 "Price box plots"
```{r}
#Clarity by price
uniform <- subset(diamonds, (color == "D" | color =="E")  & carat < 1 & carat > 0.8)
uniform2 <- subset(diamonds, (color == "F" | color =="G")  & carat < 2.2 & carat > 1.8)
uniform3 <- subset(diamonds, (color == "H" | color =="I" | color == "J") &   carat < 3.5 & carat > 2)
p1 <- qplot(x=clarity, y=price, data = uniform, geom ='boxplot')
p2 <- qplot(x=clarity, y=price, data = uniform2, geom ='boxplot')
p3 <- qplot(x=clarity, y=price, data = uniform3, geom ='boxplot')
grid.arrange(p1,p2, p3, ncol =1)

#Color by price
qplot(x = color, y = price, data = diamonds,
      binwidth = 50,
       geom = 'boxplot',
       xlab = 'Diamond color',
       fill = color) +
     scale_y_continuous( breaks = seq(0,8000,500)) +
     coord_cartesian(ylim = c(0,8000))

#Price by cut
qplot(x=cut, y=price, data=diamonds, geom="boxplot", fill=cut) +
  coord_cartesian(ylim=c(0, 10000)) +
  theme(legend.position="None")

```

### Task 11 "Interquartile Range (IQR)"
```{r}
by(diamonds$price, diamonds$color, summary)
by(diamonds$price, diamonds$color, IQR)
```

### Task 12 "Price per Carats Box and Plots by Color"
```{r}
qplot(data=diamonds, x=color, y=price/carat) +
  geom_boxplot(fill="darkgrey") +
  coord_cartesian(ylim=c(2000,6000)) +
  xlab('Color of diamonds') + ylab('Price/Carat relation of the diamonds') +
  ggtitle('Middle 50% of the price distributions from the best to the worst colors of diamonds')

uniform <- subset(diamonds,cut == "Ideal" & clarity == "IF" & carat < 1.2 & carat > 0.8)
qplot(data=uniform, x=color, y=price/carat) +
  geom_boxplot(fill="darkgrey")

```

### Task 13 "Carat frequency polygon"
```{r}
table(diamonds$carat)[table(diamonds$carat)>2000]
```


***
# Problem set 2

### Task 1 "Price vs X"
```{r}
data(diamonds)
names(diamonds)
ggplot(data = diamonds, aes(x = price, y = x)) +
  geom_point()

```

### Task 2 "Correlations"
```{r}
cor.test(diamonds$price, diamonds$x)
cor.test(diamonds$price, diamonds$y)
cor.test(diamonds$price, diamonds$z)
```

### Task 3 "Price vs Depth"
```{r}
ggplot(data = diamonds, aes(x = depth, y = price)) +
  geom_point()

```

### Task 4 "Adjustments - Price vs Depth"
```{r}
ggplot(data = diamonds, aes(x = depth, y = price)) +
  geom_point(alpha = 1/100) +
  scale_x_continuous(breaks = seq(0, 80, 2))

```

### Task 5 "Typical Depth Range"
```{r}
by(diamonds$price, diamonds$depth, summary)
```

### Task 6 "Correlation - Price and Depth"
```{r}
cor.test(diamonds$price, diamonds$depth)

```

### Task 7 "Price vs Carat"
```{r}

```

### Task 8 "Price vs Volume"
```{r}

```

### Task 9 "Correlation on subsets"
```{r}

```

### Task 10 "Adjustments - Price vs Volume"
```{r}

```

### Task 11 "Mean price by clarity"
```{r}

```

### Task 12 "Bar Charts of Mean Price"
```{r}

```

### Task 13 "Trends in Mean Price"
```{r}

```

***
# Problem set 3
